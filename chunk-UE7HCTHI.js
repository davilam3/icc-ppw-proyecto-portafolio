import{d as l,e as c,g as d,h as g,j as h,k as m,l as p,m as b,n as v,r as f,s as R}from"./chunk-U6LSLWSJ.js";import{H as s,j as t,r as u,u as n,xa as i}from"./chunk-OHUVKFVV.js";var D=class a{auth=n(c);firestore=n(v);user=s(null);currentUser=s(null);userRole=s(null);user$=d(this.auth);constructor(){h(this.auth,async e=>{this.currentUser.set(e),e?await this.cargarRolUsuario(e.uid):this.userRole.set(null)})}register(e,r){let o=g(this.auth,e,r);return t(o)}login(e,r){let o=m(this.auth,e,r);return t(o)}loginWithGoogle(){let e=new l,r=p(this.auth,e);return t(r)}logout(){let e=b(this.auth);return t(e)}isAuthenticated=i(()=>this.currentUser()!==null);async cargarRolUsuario(e){try{console.log("\u{1F50D} Buscando rol en Firestore para UID:",e);let r=await R(f(this.firestore,"usuarios",e));if(!r.exists()){console.warn("\u26A0\uFE0F Documento no existe en Firestore para UID:",e),this.userRole.set("usuario");return}let o=r.data()?.rol||"usuario";console.log("\u2705 Rol encontrado en Firestore:",o),this.userRole.set(o)}catch(r){console.error("\u274C Error obteniendo rol:",r),this.userRole.set("usuario")}}esAdmin=i(()=>this.userRole()==="admin");esProgramador=i(()=>this.userRole()==="programador");getRol(){return this.userRole()}static \u0275fac=function(r){return new(r||a)};static \u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"})};export{D as a};
