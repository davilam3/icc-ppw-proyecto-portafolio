import{a as E}from"./chunk-TUSBT566.js";import{a as P}from"./chunk-YPP5EWNF.js";import"./chunk-PG33KLFS.js";import{Ea as s,Ra as S,Rb as w,Sb as A,Tb as I,U as h,Va as _,Z as u,_ as p,a as b,b as v,cb as c,db as a,eb as n,jb as f,kb as g,mb as l,ob as o,pb as x,rb as y}from"./chunk-TZCEURQS.js";function k(i,t){i&1&&(a(0,"div",5),o(1,"No hay solicitudes a\xFAn."),n())}function T(i,t){if(i&1){let e=f();a(0,"button",17),g("click",function(){u(e);let m=l().$implicit,d=l(2);return p(d.responder(m.id,"aceptada"))}),o(1,"Aceptar"),n()}}function V(i,t){if(i&1){let e=f();a(0,"button",18),g("click",function(){u(e);let m=l().$implicit,d=l(2);return p(d.responder(m.id,"rechazada"))}),o(1,"Rechazar"),n()}}function F(i,t){if(i&1){let e=f();a(0,"button",19),g("click",function(){u(e);let m=l().$implicit,d=l(2);return p(d.verRespuesta(m))}),o(1,"Ver respuesta"),n()}}function D(i,t){if(i&1&&(a(0,"li",7)(1,"div",8)(2,"div")(3,"div",9),o(4),a(5,"span",10),o(6),n()(),a(7,"div",10),o(8,"Solicitante: "),a(9,"span",11),o(10),n()(),a(11,"div",12),o(12),n()(),a(13,"div",13),_(14,T,2,0,"button",14)(15,V,2,0,"button",15)(16,F,2,0,"button",16),n()()()),i&2){let e=t.$implicit;s(4),y("",e.fecha," ",e.hora," \u2014 "),s(2),x(e.estado),s(4),x(e.solicitanteEmail||"An\xF3nimo"),s(2),x(e.comentario),s(2),c("ngIf",e.estado==="pendiente"),s(),c("ngIf",e.estado==="pendiente"),s(),c("ngIf",e.estado!=="pendiente")}}function z(i,t){if(i&1&&(a(0,"ul"),_(1,D,17,8,"li",6),n()),i&2){let e=l();s(),c("ngForOf",e.asesorias)}}var C=class i{asesoriasService=h(E);rolesService=h(P);asesorias=[];uid="";constructor(){this.init()}async init(){let t=await this.rolesService.obtenerDatosUsuarioActual();t&&(this.uid=t.uid,await this.load())}async load(){if(!this.uid)return;let t=await this.asesoriasService.obtenerSolicitudesPorProgramador(this.uid);this.asesorias=await Promise.all(t.map(async e=>{if(!e.solicitanteUid)return v(b({},e),{solicitanteEmail:null});let r=await this.rolesService.obtenerUsuarioPorId(e.solicitanteUid);return v(b({},e),{solicitanteEmail:r?.email||null})}))}async responder(t,e){let r=prompt("Mensaje de confirmaci\xF3n/rechazo (opcional):")||"";await this.asesoriasService.actualizarEstadoSolicitud(t,e,r),await this.load()}verRespuesta(t){alert(t.respuesta||"Sin respuesta")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=S({type:i,selectors:[["app-programador-asesorias"]],decls:6,vars:2,consts:[[1,"p-6","max-w-4xl","mx-auto"],[1,"text-2xl","font-bold","mb-4"],[1,"card","p-4","shadow"],["class","text-gray-600",4,"ngIf"],[4,"ngIf"],[1,"text-gray-600"],["class","border-b py-3",4,"ngFor","ngForOf"],[1,"border-b","py-3"],[1,"flex","justify-between","items-start"],[1,"font-semibold"],[1,"text-sm"],[1,"font-medium"],[1,"text-sm","mt-1"],[1,"flex","flex-col","gap-2"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],["class","btn btn-error btn-sm",3,"click",4,"ngIf"],["class","btn btn-ghost btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"btn","btn-error","btn-sm",3,"click"],[1,"btn","btn-ghost","btn-sm",3,"click"]],template:function(e,r){e&1&&(a(0,"section",0)(1,"h2",1),o(2,"Mis Asesor\xEDas"),n(),a(3,"div",2),_(4,k,2,0,"div",3)(5,z,2,1,"ul",4),n()()),e&2&&(s(4),c("ngIf",(r.asesorias==null?null:r.asesorias.length)===0),s(),c("ngIf",r.asesorias==null?null:r.asesorias.length))},dependencies:[I,w,A],encapsulation:2})};export{C as ProgramadorAsesorias};
